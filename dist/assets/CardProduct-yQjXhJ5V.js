import{r as e,j as t,h as o,u as i,f as r,D as n,P as s,a as l,y as a,d as c}from"./vendor-Dv1Rd94t.js";import{c as d,d as u,e as p,a as f}from"./index-BxeSiO34.js";import{g as m}from"./getConfigAuth-BUruOnyX.js";function v({product:o}){const[i,r]=e.useState(0);return t.jsxs("div",{className:"slider-container",children:[t.jsx("i",{className:"bx bx-chevron-left bx-flashing slider_home_fade_button_prev left_action_modal",onClick:()=>{o&&r((e=>0===e?o.productImgs.length-1:e-1))}}),t.jsx("div",{className:"slide-wrapper",children:null==o?void 0:o.productImgs.map(((e,o)=>t.jsx("div",{className:"slide "+(o===i?"active":"inactive"),children:t.jsx("img",{className:"magnifier-img",src:null==e?void 0:e.url_medium,alt:`Slide ${o}`,style:{maxWidth:"100%",cursor:"pointer"}})},o)))}),t.jsx("i",{className:"bx bx-chevron-right bx-flashing slider_home_fade_button_next right_action_modal",onClick:()=>{o&&r((e=>e===o.productImgs.length-1?0:e+1))}})]})}const h=({product:e,setIsModal:s})=>{var l;const a=e=>{e.stopPropagation(),s(!1)},c=e=>{e.stopPropagation(),e.preventDefault()},f=o(),m=i((e=>e.cart.stateFreeToCart)),h=i((e=>e.cart.quantityProductsFree)),g=i((e=>e.cart.storedCartFree)),_=g?g.reduce(((e,t)=>e+t.quantity),0):0,b=r();return t.jsx(t.Fragment,{children:t.jsx(n,{open:a,onClose:a,fullWidth:!0,maxWidth:"md",style:{zIndex:999,overflow:"hidden"},children:t.jsx("div",{className:"modal_product_container",onTouchMove:c,onClick:a,children:t.jsxs("div",{className:"modal_container",onTouchMove:c,onClick:c,children:[t.jsx("i",{className:"bx bx-x modal_icon_close",onTouchMove:c,onClick:a}),t.jsx(v,{product:e}),t.jsxs("ul",{className:"modal_description_ul_container",children:[t.jsx("li",{className:"modal_description_poduct_title",children:null==e?void 0:e.title}),t.jsx("li",{className:"modal_description_poduct_description",children:null==e?void 0:e.description}),t.jsxs("div",{className:"modal_product_stock_size",children:[t.jsxs("li",{className:"modal_description_poduct_size",children:["Talla: ",null==(l=e.size)?void 0:l.size]}),(null==e?void 0:e.stock)<=0&&t.jsx("li",{className:"modal_description_poduct_stock",children:" Agotado "})]})]}),(null==e?void 0:e.stock)>0?t.jsx("button",{className:"modal_button button",onClick:()=>{e.stock>0?m?h!==_?(f(u({productId:e.id,price:e.sell_price,productName:e.collection.name,stock:e.stock,category:e.category.name,tittle:e.tittle,size:e.size.size,image:{url:e.productImgs&&e.productImgs.length>0?e.productImgs[0].url_medium:null,alt:e.title}})),p.fire({icon:"success",title:"¡Producto gratis agregado!",text:"Tu producto gratis ha sido agregado al carrito",confirmButtonText:"Aceptar"}),setTimeout((()=>{b("/carrito")}),500)):p.fire({icon:"info",title:"Límite alcanzado",text:"Ya has alcanzado el límite de productos gratis permitidos",confirmButtonText:"Aceptar"}):f(d({productId:e.id,price:e.sell_price,productName:e.collection.name,stock:e.stock,category:e.category.name,tittle:e.tittle,weight:e.weight,size:e.size.size,image:{url:e.productImgs&&e.productImgs.length>0?e.productImgs[0].url_medium:null,alt:e.title}})):p.fire({icon:"error",title:"Oops...",text:"No hay stock disponible",confirmButtonText:"Aceptar"})},children:t.jsx("i",{className:"bx bx-plus "})}):""]})})})})};h.propTypes={product:s.shape({id:s.number.isRequired,sell_price:s.number.isRequired,collection:s.shape({name:s.string.isRequired}).isRequired,stock:s.number.isRequired,category:s.shape({name:s.string.isRequired}).isRequired,tittle:s.string.isRequired,weight:s.number,size:s.shape({size:s.string.isRequired}).isRequired,productImgs:s.arrayOf(s.shape({url_medium:s.string})),title:s.string.isRequired,description:s.string}).isRequired,setIsModal:s.func.isRequired};var g,_={},b={};var y,x={};var w,j={};var N,k,I={};const z=c(function(){if(k)return _;k=1,Object.defineProperty(_,"__esModule",{value:!0}),_.forceVisible=_.forceCheck=_.lazyload=void 0;var e=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),t=l(),o=d(t),i=d(a()),r=(g||(g=1,Object.defineProperty(b,"__esModule",{value:!0}),b.on=function(e,t,o,i){i=i||!1,e.addEventListener?e.addEventListener(t,o,i):e.attachEvent&&e.attachEvent("on"+t,(function(t){o.call(e,t||window.event)}))},b.off=function(e,t,o,i){i=i||!1,e.removeEventListener?e.removeEventListener(t,o,i):e.detachEvent&&e.detachEvent("on"+t,o)}),b),n=d((y||(y=1,Object.defineProperty(x,"__esModule",{value:!0}),x.default=function(e){if(!(e instanceof HTMLElement))return document.documentElement;for(var t="absolute"===e.style.position,o=/(scroll|auto)/,i=e;i;){if(!i.parentNode)return e.ownerDocument||document.documentElement;var r=window.getComputedStyle(i),n=r.position,s=r.overflow,l=r["overflow-x"],a=r["overflow-y"];if("static"===n&&t)i=i.parentNode;else{if(o.test(s)&&o.test(l)&&o.test(a))return i;i=i.parentNode}}return e.ownerDocument||e.documentElement||document.documentElement}),x)),s=d((w||(w=1,Object.defineProperty(j,"__esModule",{value:!0}),j.default=function(e,t,o){var i=void 0,r=void 0,n=void 0,s=void 0,l=void 0,a=function a(){var c=+new Date-s;c<t&&c>=0?i=setTimeout(a,t-c):(i=null,o||(l=e.apply(n,r),i||(n=null,r=null)))};return function(){n=this,r=arguments,s=+new Date;var c=o&&!i;return i||(i=setTimeout(a,t)),c&&(l=e.apply(n,r),n=null,r=null),l}}),j)),c=d((N||(N=1,Object.defineProperty(I,"__esModule",{value:!0}),I.default=function(e,t,o){var i,r;return t||(t=250),function(){var n=o||this,s=+new Date,l=arguments;i&&s<i+t?(clearTimeout(r),r=setTimeout((function(){i=s,e.apply(n,l)}),t)):(i=s,e.apply(n,l))}}),I));function d(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=0,v=0,h=0,z=0,C="data-lazyload-listened",E=[],O=[],P=!1;try{var R=Object.defineProperty({},"passive",{get:function(){P=!0}});window.addEventListener("test",null,R)}catch(F){}var T=!!P&&{capture:!1,passive:!0},M=function(e){var t=e.ref;if(t instanceof HTMLElement){var o=(0,n.default)(t),i=e.props.overflow&&o!==t.ownerDocument&&o!==document&&o!==document.documentElement?function(e,t){var o=e.ref,i=void 0,r=void 0,n=void 0,s=void 0;try{var l=t.getBoundingClientRect();i=l.top,r=l.left,n=l.height,s=l.width}catch(F){i=m,r=v,n=z,s=h}var a=window.innerHeight||document.documentElement.clientHeight,c=window.innerWidth||document.documentElement.clientWidth,d=Math.max(i,0),u=Math.max(r,0),p=Math.min(a,i+n)-d,f=Math.min(c,r+s)-u,g=void 0,_=void 0,b=void 0,y=void 0;try{var x=o.getBoundingClientRect();g=x.top,_=x.left,b=x.height,y=x.width}catch(F){g=m,_=v,b=z,y=h}var w=g-d,j=_-u,N=Array.isArray(e.props.offset)?e.props.offset:[e.props.offset,e.props.offset];return w-N[0]<=p&&w+b+N[1]>=0&&j-N[0]<=f&&j+y+N[1]>=0}(e,o):function(e){var t=e.ref;if(!(t.offsetWidth||t.offsetHeight||t.getClientRects().length))return!1;var o=void 0,i=void 0;try{var r=t.getBoundingClientRect();o=r.top,i=r.height}catch(F){o=m,i=z}var n=window.innerHeight||document.documentElement.clientHeight,s=Array.isArray(e.props.offset)?e.props.offset:[e.props.offset,e.props.offset];return o-s[0]<=n&&o+i+s[1]>=0}(e);i?e.visible||(e.props.once&&O.push(e),e.visible=!0,e.forceUpdate()):e.props.once&&e.visible||(e.visible=!1,e.props.unmountIfInvisible&&e.forceUpdate())}},q=function(){O.forEach((function(e){var t=E.indexOf(e);-1!==t&&E.splice(t,1)})),O=[]},S=function(){for(var e=0;e<E.length;++e){var t=E[e];M(t)}q()},L=void 0,A=null,D=function(t){function i(e){u(this,i);var t=p(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return t.visible=!1,t.setRef=t.setRef.bind(t),t}return f(i,t),e(i,[{key:"componentDidMount",value:function(){var e=window,t=this.props.scrollContainer;t&&"string"==typeof t&&(e=e.document.querySelector(t));var o=void 0!==this.props.debounce&&"throttle"===L||"debounce"===L&&void 0===this.props.debounce;if(o&&((0,r.off)(e,"scroll",A,T),(0,r.off)(window,"resize",A,T),A=null),A||(void 0!==this.props.debounce?(A=(0,s.default)(S,"number"==typeof this.props.debounce?this.props.debounce:300),L="debounce"):void 0!==this.props.throttle?(A=(0,c.default)(S,"number"==typeof this.props.throttle?this.props.throttle:300),L="throttle"):A=S),this.props.overflow){var i=(0,n.default)(this.ref);if(i&&"function"==typeof i.getAttribute){var l=+i.getAttribute(C)+1;1===l&&i.addEventListener("scroll",A,T),i.setAttribute(C,l)}}else if(0===E.length||o){var a=this.props,d=a.scroll,u=a.resize;d&&(0,r.on)(e,"scroll",A,T),u&&(0,r.on)(window,"resize",A,T)}E.push(this),M(this)}},{key:"shouldComponentUpdate",value:function(){return this.visible}},{key:"componentWillUnmount",value:function(){if(this.props.overflow){var e=(0,n.default)(this.ref);if(e&&"function"==typeof e.getAttribute){var t=+e.getAttribute(C)-1;0===t?(e.removeEventListener("scroll",A,T),e.removeAttribute(C)):e.setAttribute(C,t)}}var o=E.indexOf(this);-1!==o&&E.splice(o,1),0===E.length&&"undefined"!=typeof window&&((0,r.off)(window,"resize",A,T),(0,r.off)(window,"scroll",A,T))}},{key:"setRef",value:function(e){e&&(this.ref=e)}},{key:"render",value:function(){var e=this.props,t=e.height,i=e.children,r=e.placeholder,n=e.className,s=e.classNamePrefix,l=e.style;return o.default.createElement("div",{className:s+"-wrapper "+n,ref:this.setRef,style:l},this.visible?i:r||o.default.createElement("div",{style:{height:t},className:s+"-placeholder"}))}}]),i}(t.Component);return D.propTypes={className:i.default.string,classNamePrefix:i.default.string,once:i.default.bool,height:i.default.oneOfType([i.default.number,i.default.string]),offset:i.default.oneOfType([i.default.number,i.default.arrayOf(i.default.number)]),overflow:i.default.bool,resize:i.default.bool,scroll:i.default.bool,children:i.default.node,throttle:i.default.oneOfType([i.default.number,i.default.bool]),debounce:i.default.oneOfType([i.default.number,i.default.bool]),placeholder:i.default.node,scrollContainer:i.default.oneOfType([i.default.string,i.default.object]),unmountIfInvisible:i.default.bool,style:i.default.object},D.defaultProps={className:"",classNamePrefix:"lazyload",once:!1,offset:0,overflow:!1,resize:!1,scroll:!0,unmountIfInvisible:!1},_.lazyload=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){return function(t){function n(){u(this,n);var e=p(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.displayName="LazyLoad"+function(e){return e.displayName||e.name||"Component"}(r),e}return f(n,t),e(n,[{key:"render",value:function(){return o.default.createElement(D,i,o.default.createElement(r,this.props))}}]),n}(t.Component)}},_.default=D,_.forceCheck=S,_.forceVisible=function(){for(var e=0;e<E.length;++e){var t=E[e];t.visible=!0,t.forceUpdate()}q()},_}()),C={VITE_API_URL_PROD:"https://www.everchic.ec/api/v1"},E=({product:n,isSlider:s})=>{var l,a;const[c,p]=e.useState(!1),[v,g]=e.useState({x:0}),[_,b]=e.useState({x:0}),y=e.useRef(),x=o(),w=i((e=>e.cart.stateFreeToCart)),j=i((e=>e.cart.quantityProductsFree)),N=i((e=>e.cart.storedCartFree)),k=N?N.reduce(((e,t)=>e+t.quantity),0):0,I=r(),E=i((e=>e.cart.storedCart)),O=E&&E.length>0?E[0].priceUnit.toFixed(2):"5.00",P=i((e=>{var t;return null==(t=e.user.data)?void 0:t.id})),{updateLikeProducts:R,getLikeProducts:T}=(()=>{const{VITE_API_URL_PROD:e}=C,t=e,o=i((e=>{var t;return null==(t=e.user.data)?void 0:t.id}));let r=[];return{updateLikeProducts:async e=>{try{if(o){const i=await f.put(`${t}/users/like_update_product/`,{userId:o,productId:e},m());"Like agregado"===i.data.message?r.push(e):"Like eliminado"===i.data.message&&(r=r.filter((t=>t!==e)))}else{const t=localStorage.getItem("likes");r=t?JSON.parse(t):[],r.includes(e)?r=r.filter((t=>t!==e)):r.push(e)}localStorage.setItem("likes",JSON.stringify(r))}catch(i){}return r},getLikeProducts:async()=>{if(o){const e=await f.get(`${t}/users/like_product/${o}`,m());r=e.data.map((e=>e.productId)),localStorage.setItem("likes",JSON.stringify(r))}else{const e=localStorage.getItem("likes");r=e?JSON.parse(e):[]}return r}}})(),[M,q]=e.useState(!1),[S,L]=e.useState(!1);e.useEffect((()=>{A()}),[]);const A=async()=>{const e=(await T()).includes(n.id);L(!!e)},D=async()=>{if(P){(await R(n.id,P)).includes(n.id)?A():L(!1)}},[F,U]=e.useState(!1),B=E.find((e=>e.productId==n.id))||!1;return e.useEffect((()=>{B&&B.quantity==B.stock?U(!0):U(!1)}),[B.quantity]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{ref:y,className:`card_product_container ${w?"gold":""} ${s&&"is_slider"}`,onMouseDown:()=>{const e=y.current.getBoundingClientRect();g({x:e.x})},onMouseUp:()=>{const e=y.current.getBoundingClientRect();b({x:e.x})},onClick:()=>{Math.abs(_.x-v.x)<=3&&p(!0)},children:[t.jsxs("div",{className:"card_container_img",children:[t.jsx("i",{className:"bx bxs-heart "+(S?"heart-fill":""),onClick:e=>{e.stopPropagation(),L(!0),q(!M),D()}}),t.jsxs("p",{className:"card_product_size",children:[" Talla ",null==(l=n.size)?void 0:l.size]}),t.jsx(z,{children:t.jsx("img",{className:"card_product_img",src:(null==n?void 0:n.productImgs[0])&&(null==(a=null==n?void 0:n.productImgs[0])?void 0:a.url_small),alt:"image"})})]}),t.jsxs("div",{className:"card_product_body",children:[t.jsxs("div",{className:"card_title_category",children:[t.jsx("p",{className:"card_product_name",children:null==n?void 0:n.title}),t.jsx("p",{className:"card_product_price",children:w?"Free":`$ ${O}`})]}),t.jsx("div",{className:"card_product_by_container",children:0==n.stock||F?t.jsx("div",{className:"card_product_stock",children:t.jsx("span",{className:"card_product_text_sold_out",children:"Agotado"})}):t.jsx("button",{className:"card_product_button_cart button",onClick:e=>{var t,o,i,r,s,l;e.stopPropagation(),Math.abs(_.x-v.x)<=3&&(!w&&n?x(d({productId:null==n?void 0:n.id,price:null==n?void 0:n.sell_price,productName:null==(t=null==n?void 0:n.collection)?void 0:t.name,stock:null==n?void 0:n.stock,category:null==(o=null==n?void 0:n.category)?void 0:o.name,title:null==n?void 0:n.title,size:null==(i=null==n?void 0:n.size)?void 0:i.size,weight:null==n?void 0:n.weight,image:{url:(null==n?void 0:n.productImgs)&&n.productImgs.length>0?n.productImgs[0].url_small:null,alt:null==n?void 0:n.title}})):j!==k&&(x(u({productId:null==n?void 0:n.id,price:null==n?void 0:n.sell_price,productName:null==(r=null==n?void 0:n.collection)?void 0:r.name,stock:null==n?void 0:n.stock,weight:null==n?void 0:n.weight,category:null==(s=null==n?void 0:n.category)?void 0:s.name,title:null==n?void 0:n.title,size:null==(l=null==n?void 0:n.size)?void 0:l.size,image:{url:(null==n?void 0:n.productImgs)&&n.productImgs.length>0?n.productImgs[0].url_small:null,alt:null==n?void 0:n.title}})),j-k==1&&I("/carrito")))},children:t.jsx("i",{className:"bx bx-plus card_button_plus"})})})]})]}),c&&t.jsx(h,{product:n,setIsModal:p})]})};E.propTypes={product:s.shape({id:s.number.isRequired,sell_price:s.number,collection:s.shape({name:s.string}),stock:s.number,category:s.shape({name:s.string}),title:s.string,size:s.shape({size:s.string}),weight:s.number,productImgs:s.arrayOf(s.shape({url_small:s.string}))}).isRequired,isSlider:s.bool};export{E as C};
